kind: Model
name: nyc_taxi_monitoring
runtime: "hydrosphere/serving-runtime-python-3.6:0.1.2-rc0"
install-command: "pip install -r requirements.txt"
payload:
  - "monitoring_model/src/"
  - "monitoring_model/requirements.txt"
  - "monitoring_model/iforest.joblib"
contract:
  name: infer
  inputs:
    pickups_last_hour:
      shape: scalar
      type: int32
      profile: numerical
    pickups_next_hour:
      shape: scalar
      type: int32
      profile: numerical
  outputs:
    value:
      shape: scalar
      type: double
      profile: numerical

---
kind: Application
name: "nyc_taxi_monitoring"
singular:
  model: nyc_taxi_monitoring:1

---
kind: Model
name: nyc_taxi
runtime: "hydrosphere/serving-runtime-python-3.6:0.1.2-rc0"
install-command: "pip install -r requirements.txt"
payload:
  - "model/src/"
  - "model/requirements.txt"
  - "model/model.joblib"
contract:
  name: infer
  inputs:
    pickups_last_hour:
      shape: scalar
      type: int32
      profile: numerical
  outputs:
    pickups_next_hour:
      shape: scalar
      type: int32
      profile: numerical
monitoring:
  - name: "IsolationForest"
    kind: CustomModelMetricSpec
    with-health: true
    config:
      application: "nyc_taxi_monitoring"
      threshold: "0"
      operator: ">="
---
kind: Application
name: "nyc_taxi"
singular:
  model: nyc_taxi:1
